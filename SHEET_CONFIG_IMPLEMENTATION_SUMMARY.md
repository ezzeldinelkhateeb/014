# ุฅุนุฏุงุฏุงุช Google Sheets - ููุฎุต ุงูุชูููุฐ ุงูููุงุฆู

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. ูุฏูุฑ ุฅุนุฏุงุฏุงุช ุงูุดูุช (Sheet Config Manager)
- **ุงูููู**: `src/lib/sheet-config/sheet-config-manager.ts`
- **ุงููุธุงุฆู**:
  - ุญูุธ ูุชุญููู ุฅุนุฏุงุฏุงุช ูุชุนุฏุฏุฉ ูู Google Sheets
  - ุชุญุฏูุฏ ุงูุดูุช ุงูุงูุชุฑุงุถู
  - ุฅุฏุงุฑุฉ ุงูุฅุนุฏุงุฏุงุช ูู Local Storage
  - validation ููุฅุนุฏุงุฏุงุช

### 2. ููููุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู
- **SheetConfigSelector**: `src/components/sheet-settings/SheetConfigSelector.tsx`
  - DropDown ูุงุฎุชูุงุฑ ุงูุดูุช ุงููุทููุจ
  - ุนุฑุถ ูุนูููุงุช ุงูุดูุช (ุงูุงุณูุ IDุ ุงูุฃุนูุฏุฉ)
  - ุฒุฑ ุฅุฏุงุฑุฉ ุงูุฅุนุฏุงุฏุงุช
  
- **SheetConfigDialog**: `src/components/sheet-settings/SheetConfigDialog.tsx`
  - ูุงูุฐุฉ ุฅุถุงูุฉ/ุชุนุฏูู ุฅุนุฏุงุฏุงุช ุงูุดูุช
  - ุฅุฏุฎุงู ุฑุงุจุท ุงูุดูุชุ ุงุณู ุงููุฑูุฉุ ุฃุนูุฏุฉ ุงูุจูุงูุงุช
  - validation ูุญูุธ ุงูุฅุนุฏุงุฏุงุช

### 3. ุชูุงูู ุงููุธุงู - ุทุจูุฉ ุงูุฅุฏุงุฑุฉ
- **UploadManager**: `src/lib/upload-manager.ts`
  - `updateSheetConfig(config)`: ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุดูุช
  - `getCurrentSheetConfig()`: ุงูุญุตูู ุนูู ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ
  - ุชูุฑูุฑ ุงูุฅุนุฏุงุฏุงุช ุฅูู SheetUpdater

- **SheetUpdater**: `src/lib/upload/sheet-updater.ts`
  - `setSheetConfig(config)`: ุงุณุชูุจุงู ุฅุนุฏุงุฏุงุช ุงูุดูุช
  - `getCurrentSheetConfig()`: ุฅุฑุฌุงุน ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ
  - ุชูุฑูุฑ ุงูุฅุนุฏุงุฏุงุช ุฅูู Worker

### 4. ุชูุงูู ุงููุธุงู - ุทุจูุฉ ุงูุชูููุฐ
- **Worker**: `src/lib/upload/sheet-update.worker.ts`
  - ุงุณุชูุจุงู ุดูุช config ูู ุงูู updater
  - ุงุณุชุฎุฏุงู ุงูุฅุนุฏุงุฏุงุช ุงููุฎุตุตุฉ ูู API calls
  - fallback ุฅูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุฅุฐุง ูู ุชุชููุฑ ุฅุนุฏุงุฏุงุช ูุฎุตุตุฉ

- **useSheetUpdater Hook**: `src/hooks/useSheetUpdater.ts`
  - ูุฃุฎุฐ ุฏุงูุฉ `getCurrentSheetConfig` ูู parameter
  - ูุณุชุฎุฏู ุงูุฅุนุฏุงุฏุงุช ุงููุฎุตุตุฉ ูู ูู ูู:
    - `updateSheetForVideo`: ุชุญุฏูุซ ุดูุช ููููุฏูู ุงููุงุญุฏ
    - `handleUpdateSheet`: ุชุญุฏูุซ ุฌูุงุนู ููู embed codes
    - `handleUpdateFinalMinutes`: ุชุญุฏูุซ ุงูุฏูุงุฆู ุงูููุงุฆูุฉ

### 5. ุชุญุฏูุซ ุงูู API Endpoints
- **`/api/sheets/update-bunny-embeds`** ูู `server.js`:
  - ููุจู ุงูุขู ุฅุนุฏุงุฏุงุช ุดูุช ูุฎุตุตุฉ:
    - `spreadsheetId`, `sheetName`, `nameColumn`, `embedColumn`, `finalMinutesColumn`
  - ูุณุชุฎุฏู column letters ุฏููุงููููุงู ุจุฏูุงู ูู hardcoded indices
  - helper function `columnToIndex()` ูุชุญููู ุญุฑูู ุงูุฃุนูุฏุฉ ุฅูู ุฃุฑูุงู

- **`/api/sheets/update-final-minutes`** ูู `server.js`:
  - ูุงู ูุญุฏุซ ูุณุจูุงู ููุฏุนู ุงูุฅุนุฏุงุฏุงุช ุงููุฎุตุตุฉ
  - ูุณุชุฎุฏู ุงูุฅุนุฏุงุฏุงุช ุงููุฑุณูุฉ ูู ุงููุงุฌูุฉ

### 6. ุชูุงูู VideoProcessingForm
- **ุงูููู**: `src/components/VideoProcessingForm.tsx`
- ุชููุฆุฉ ุฅุนุฏุงุฏุงุช ุงูุดูุช ุงูุงูุชุฑุงุถูุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู
- ุชูุฑูุฑ `getCurrentSheetConfig` ุฅูู useSheetUpdater
- ุชุทุจูู ุงูุฅุนุฏุงุฏุงุช ุงููุฎุชุงุฑุฉ ุนูู UploadManager
- logging ููุตู ูุชุชุจุน ุงูุฅุนุฏุงุฏุงุช ุงููุณุชุฎุฏูุฉ

## ๐ ุณูุณูุฉ ุชุฏูู ุงูุจูุงูุงุช

```
UI DropDown โ SheetConfigSelector โ VideoProcessingForm 
     โ
UploadManager.updateSheetConfig() 
     โ
SheetUpdater.setSheetConfig()
     โ
Worker (ูู ุชุญุฏูุซ ุงูุดูุช)
     โ
API Endpoint ูุน ุงูุฅุนุฏุงุฏุงุช ุงููุฎุตุตุฉ
```

## ๐ ูุง ูุญุชุงุฌ ููุงุฎุชุจุงุฑ ุงูุนููู

### 1. ุงุฎุชุจุงุฑ ุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช ุฌุฏูุฏุฉ:
- [ ] ูุชุญ VideoProcessing page
- [ ] ุงูููุฑ ุนูู ุฒุฑ ุฅุฏุงุฑุฉ ุงูุฅุนุฏุงุฏุงุช ูู SheetConfigSelector
- [ ] ุฅุถุงูุฉ ุดูุช ุฌุฏูุฏ ุจุฑุงุจุท ูุฅุนุฏุงุฏุงุช ูุฎุชููุฉ
- [ ] ุงูุชุฃูุฏ ูู ุธููุฑู ูู DropDown

### 2. ุงุฎุชุจุงุฑ ุชุบููุฑ ุงูุดูุช ุงูุงูุชุฑุงุถู:
- [ ] ุงุฎุชูุงุฑ ุดูุช ูุฎุชูู ูู DropDown
- [ ] ุชุณุฌูู ููุฏูู ุฌุฏูุฏ ููุฑุงูุจุฉ console logs
- [ ] ุงูุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ุงูุดูุช ุงููุฎุชุงุฑ ูููุณ ุงูุงูุชุฑุงุถู ูู .env

### 3. ุงุฎุชุจุงุฑ ุนูููุงุช ุชุญุฏูุซ ุงูุดูุช:
- [ ] ุงุฎุชูุงุฑ ููุฏูููุงุช ููุฌูุฏุฉ
- [ ] ุงูููุฑ ุนูู "Update Sheet" ุฃู "Update Final Minutes"
- [ ] ูุฑุงูุจุฉ console logs ููุชุฃูุฏ ูู ุฅุฑุณุงู ุงูุฅุนุฏุงุฏุงุช ุงูุตุญูุญุฉ
- [ ] ุงูุชุญูู ูู ุชุญุฏูุซ ุงูุดูุช ุงูุตุญูุญ

### 4. ุงุฎุชุจุงุฑ ุงุณุชุฎุฏุงู ุฃุนูุฏุฉ ูุฎุตุตุฉ:
- [ ] ุฅูุดุงุก ุดูุช config ุจุฃุนูุฏุฉ ุบูุฑ ุงูุชุฑุงุถูุฉ (ูุซู A, B, C ุจุฏูุงู ูู M, V, P)
- [ ] ุชุณุฌูู ููุฏูู ุฃู ุชุญุฏูุซ ุดูุช
- [ ] ุงูุชุฃูุฏ ูู ูุชุงุจุฉ ุงูุจูุงูุงุช ูู ุงูุฃุนูุฏุฉ ุงูุตุญูุญุฉ

## ๐จ ููุงุท ูููุฉ ููุงุฎุชุจุงุฑ

1. **Console Logging**: ุชู ุฅุถุงูุฉ logging ููุตู ูู ูู ุทุจูุฉ ูุชุณููู ุงูุชุชุจุน:
   ```
   [VideoProcessingForm] ๐ Using custom sheet config
   [UploadManager] ๐ Updated sheet config
   [SheetUpdater] ๐ Using custom sheet config
   [Worker] ๐ Using custom sheet config
   [Sheet Update] ๐ Using custom sheet config
   ```

2. **Fallback Behavior**: ุฅุฐุง ูู ุชูู ููุงู ุฅุนุฏุงุฏุงุช ูุฎุตุตุฉุ ุงููุธุงู ูุณุชุฎุฏู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ

3. **Column Mapping**: ุงููุธุงู ูุฏุนู ุงูุขู ุฃู ุฃุนูุฏุฉ ูู ุงูุดูุช (A-Z, AA-ZZ, etc.) ูููุณ ูุญุฏูุฏ ุจู M, V, P

## ๐ ูุชุทูุจุงุช ุงุฎุชุจุงุฑ ุฅุถุงููุฉ

- ุฅูุดุงุก ุฃู ุงุณุชุฎุฏุงู Google Sheet ููุงุฎุชุจุงุฑ ูุน permissions ููุงุณุจุฉ
- ุงูุชุฃูุฏ ูู ุตุญุฉ Google Sheets API credentials ูู `.env`
- ุงุฎุชุจุงุฑ scenarios ูุฎุชููุฉ ูุซู ุดูุชุงุช ูุชุนุฏุฏุฉ ูุฃุนูุฏุฉ ูุฎุชููุฉ

## ๐ง ุชุญุณููุงุช ูุณุชูุจููุฉ ูุญุชููุฉ

1. ุฅุถุงูุฉ ุชุดููุฑ ูุฅุนุฏุงุฏุงุช ุงูุดูุช ูู Local Storage
2. ุฅุถุงูุฉ validation ุฃููู ูุฑูุงุจุท Google Sheets
3. ุฅุถุงูุฉ test connection functionality ููู ุดูุช config
4. ุฏุนู import/export ููุฅุนุฏุงุฏุงุช
5. ุฅุถุงูุฉ templates ูุฅุนุฏุงุฏุงุช ุดูุชุงุช ุดุงุฆุนุฉ
